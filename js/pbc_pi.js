/*
 * Author: Svitlana Orlova
 * Repository: https://github.com/svitlana-orlova/PI
 * Description:
 *
 * JS version of the famous PI digits generator
 * https://crypto.stanford.edu/pbc/notes/pi/code.html
 */

const pbc_round = Math.floor;

function pbc_pi()
{
    let r = Array.from({ length: 2800 + 1 }, (_, i) => 2000);
    let [i, c, k, b, d] = [2800, 0];
    let result = [];

    r[i] = 0;

    for (k = 2800; k > 0; k -= 14) {
        d = 0;
        i = k;

        for (;;) {
            d += r[i] * 10000;
            b = 2 * i - 1;

            r[i] = pbc_round(d % b);
            d = pbc_round(d / b);
            i--;

            if (i == 0) {
                break;
            }

            d *= i;
        }

        result.push(pbc_round(c + d / 10000));
        c = pbc_round(d % 10000);
    }

    return result;
}

const assert = require('assert');
const BIG_PI= "\
31415926535897932384626433832795288419716939937510582097494459\
23078164062862089986280348253421170679821480865132823664709384\
46955582231725359408128481117450284127019385211555964462294895\
49303819644288109756659334461284756482337867831652712019914564\
85669234634861045432664821339360726024914127372458706606315588\
17488152092096282925491715364367892590361133053054882046652138\
41469519415116094330572736575959195309218611738193261179310511\
85480744623799627495673518857527248912279381830119491298336733\
62440656643860213949463952247371907021798694370277053921717629\
31767523846748184676694513200056812714526356082778577134275778\
96091736371787214684409012249534301465495853710579227968925892\
35420199561121290219686434418159813629774771309960518707211349\
9999983729780499510597317328160963185";

assert(BIG_PI == pbc_pi().join(''));
